<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>MonthVest - Investment Suggestions</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<style>
    body { font-family: Arial, sans-serif; margin: 0; background-color: #f5f6fa; display: flex; }

    /* Sidebar */
    .sidebar {
        width: 220px; background-color: #6a11cb; color: #fff; display: flex; flex-direction: column; padding: 30px 20px; height: 100vh; position: fixed;
    }
    .sidebar a { color: #fff; text-decoration: none; margin-bottom: 20px; font-size: 1.1rem; transition: 0.2s; padding: 10px; border-radius: 6px; display: flex; align-items: center; }
    .sidebar a:hover { background-color: #7b33d6; }
    .sidebar a i { margin-right: 10px; }

    /* Main content */
    .main-content { margin-left: 240px; padding: 30px; width: calc(100% - 240px); }
    h2 { margin-bottom: 20px; }

    .suggestion-box {
        background-color: #fff; padding: 20px; border-radius: 10px; margin-bottom: 20px; box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    }

    .risk-badge {
        padding: 5px 10px; border-radius: 6px; color: #fff; font-weight: bold; display: inline-block;
    }
    .low { background-color: #28a745; }
    .medium { background-color: #fd7e14; }
    .high { background-color: #dc3545; }
</style>
</head>
<body>

<!-- Sidebar -->
<div class="sidebar">
    <a href="dashboard.html"><i class="fas fa-tachometer-alt"></i> Dashboard</a>
    <a href="add_investment.html"><i class="fas fa-plus-circle"></i> Add Investment</a>
    <a href="edit_delete.html"><i class="fas fa-edit"></i> Edit / Delete</a>
     <a href="portfolio_trends.html"><i class="fas fa-chart-line"></i> Portfolio Trends</a>
    <a href="investment_tips.html"><i class="fas fa-lightbulb"></i> Investment Tips</a>
    <a href="reports.html"><i class="fas fa-file-alt"></i> Reports</a>
    <a href="user_profile.html"><i class="fas fa-user-circle"></i> User Profile</a>
</div>

<!-- Main Content -->
<div class="main-content">
    <h2>Investment Suggestions</h2>

    <div class="suggestion-box" id="dynamic-suggestions">
        <h3>Personalized Suggestions Based on Your Portfolio</h3>
        <ul id="suggestionList"></ul>
        <p>Portfolio Risk Level: <span id="riskLevel" class="risk-badge">-</span></p>
    </div>
</div>

<script>
// Fetch investment data from localStorage
let investments = JSON.parse(localStorage.getItem('investments')) || [];
let suggestionList = document.getElementById('suggestionList');
let riskBadge = document.getElementById('riskLevel');

// Function to analyze investments
function generateSuggestions(investments) {
    let suggestions = [];
    let risk = "Low";

    if(investments.length === 0){
        suggestions.push("No investments found. Start adding your investments to get suggestions.");
        risk = "Low";
        return {suggestions, risk};
    }

    // Calculate total portfolio and category-wise returns
    let totalInvested = 0;
    let totalReturns = 0;
    let categoryReturns = {};

    investments.forEach(inv => {
        totalInvested += inv.amount;
        totalReturns += (inv.currentValue - inv.amount);
        categoryReturns[inv.type] = (categoryReturns[inv.type] || 0) + (inv.currentValue - inv.amount);
    });

    // Suggest moving from negative/low performing categories
    for(let type in categoryReturns){
        if(categoryReturns[type] < 0){
            suggestions.push(`Consider reducing investment in ${type}, it is performing poorly.`);
        } else if(categoryReturns[type] / totalInvested < 0.05){
            suggestions.push(`Your investment in ${type} is small. Consider increasing exposure if suitable.`);
        }
    }

    // Portfolio risk level calculation (simple heuristic)
    let positiveReturns = Object.values(categoryReturns).filter(val => val > 0);
    let negativeReturns = Object.values(categoryReturns).filter(val => val <= 0);
    let negativeRatio = negativeReturns.length / Object.keys(categoryReturns).length;

    if(negativeRatio > 0.6){
        risk = "High";
    } else if(negativeRatio > 0.3){
        risk = "Medium";
    } else {
        risk = "Low";
    }

    // Suggest diversification if portfolio is dominated by one type
    let maxCategory = Object.keys(categoryReturns).reduce((a,b) => categoryReturns[a] > categoryReturns[b] ? a : b);
    let maxValue = categoryReturns[maxCategory];
    if(maxValue / totalInvested > 0.7){
        suggestions.push(`Your portfolio is heavily concentrated in ${maxCategory}. Consider diversifying.`);
    }

    if(suggestions.length === 0){
        suggestions.push("Your portfolio is well balanced. Keep monitoring your investments.");
    }

    return {suggestions, risk};
}

// Generate and display
let result = generateSuggestions(investments);
result.suggestions.forEach(s => {
    let li = document.createElement('li');
    li.innerText = s;
    suggestionList.appendChild(li);
});
riskBadge.innerText = result.risk;
riskBadge.classList.add(result.risk.toLowerCase());

</script>

</body>
</html>
